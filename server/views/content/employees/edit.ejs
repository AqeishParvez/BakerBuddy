<div class="container">
    <div class="row">
        <div class="offset-md-3 col-md-6">
            <h1><%= title %></h1>

            <form class="form" method="POST">
                <input type="hidden" name="id" value="<%= employee._id %>">

                <div class="form-group">
                    <label for="firstNameTextField">First Name</label>
                    <input type="text" class="form-control"
                        id="firstNameTextField"
                        placeholder="Enter the First Name"
                        name="firstName"
                        value="<%= employee.firstName %>"
                        required>
                </div>

                <div class="form-group">
                    <label for="lastNameTextField">Last Name</label>
                    <input type="text" class="form-control"
                        id="lastNameTextField"
                        placeholder="Enter the Last Name"
                        name="lastName"
                        value="<%= employee.lastName %>"
                        required>
                </div>

                <div class="form-group">
                    <label for="emailTextField">Email</label>
                    <input type="email" class="form-control"
                        id="emailTextField"
                        placeholder="Enter the Email"
                        name="email"
                        value="<%= employee.email %>"
                        required>
                </div>

                <!-- Locked and autogenerated username field -->
                <div class="form-group">
                    <label for="usernameTextField">Username (Autogenerated)</label>
                    <input type="text" class="form-control"
                        id="usernameTextField"
                        placeholder="Autogenerated Username"
                        name="username"
                        value="<%= employee.username %>"
                        readonly>
                </div>

                <div class="form-group">
                    <label for="roleSelect">Role</label>
                    <select class="form-control" id="roleSelect" name="role" required>
                        <option value="Admin" <%= (employee.role === 'Admin') ? 'selected' : '' %>>Admin</option>
                        <option value="Manager" <%= (employee.role === 'Manager') ? 'selected' : '' %>>Manager</option>
                        <option value="Baker" <%= (employee.role === 'Baker') ? 'selected' : '' %>>Baker</option>
                        <!-- Add other roles as needed -->
                    </select>
                </div>

                <!-- Locked registration code field with reset button -->
                <div class="form-group">
                    <label for="registrationCodeTextField">Registration Code (Autogenerated)</label>
                    <input type="text" class="form-control"
                        id="registrationCodeTextField"
                        placeholder="Autogenerated Registration Code"
                        name="registrationCode"
                        value="<%= employee.registrationCode %>"
                        readonly>
                    <button type="button" class="btn btn-secondary" onclick="resetRegistrationCode()">
                        Reset Registration Code
                    </button>
                </div>

                <!-- Locked registered field -->
                <div class="form-group">
                    <label for="registeredCheckbox">Registered</label>
                    <input type="checkbox" class="form-check-input"
                        id="registeredCheckbox"
                        name="registered"
                        value="<%= employee.registered %>"
                        disabled>
                </div>

                <button class="btn btn-primary" type="submit">
                    <i class="fas fa-edit"></i> Submit</button>

                <a href="/employees/list" class="btn btn-warning">
                    <i class="fas fa-undo"></i> Cancel</a>
            </form>
        </div>
    </div>
</div>

<script>
    // Include the generateUniquePinCode function directly in the EJS template
    function generateUniquePinCode() {
        // For simplicity, we'll use a basic example here
        return Math.floor(1000 + Math.random() * 9000).toString();
    }

    function resetRegistrationCode() {
        // Call the generateUniquePinCode function to reset the registration code
        var newRegistrationCode = generateUniquePinCode();
        
        // Update the input field with the new registration code
        document.getElementById('registrationCodeTextField').value = newRegistrationCode;

        // Trigger form submission to send the updated registration code to the server
        document.querySelector('.form').submit();
    }
</script>
